SELECT 
FR.ID_FORNECEDOR,
FR.RAZ_SOCIAL, 
FR.CNPJ, 
FR.IE,
FR.ENDERECO,
FR.MUNICIPIO,
FR.UF,
FR.CEP,
FR.FONE,  
NC.ID AS ID_NOTA,
NC.NOTA AS NUM_NOTA,
NC.SERIE,
NC.DATA_EMISSAO,
NC.DATA_LANC,
NC.DATA_SAIDA,
NC.BASE_ICMS AS NC_BASE_ICMS,
NC.VALOR_ICMS,
NC.BASE_ICMS_SUB,
NC.VALOR_ICMS_SUB,
NC.VALOR_FRETE,
NC.VALOR_SEGURO,
NC.OUTRAS_DESPESAS,
NC.VALOR_IPI,
NC.VALOR_PIS,
NC.VALOR_COFINS,
NC.VALOR_DESCONTO,
NC.VALOR_PRODUTOS,
NC.VALOR_TOTAL,
NC.NFE_CHAVE,
NCI.ITEM AS NUM_ITEM,
NCI.ID_PRODUTO,
P.PRODUTO,
NCI.CFOP,
NCI.QUANTIDADE,
NCI.VALOR_UNITARIO,
NCI.TOTAL_ITEM,
NCI.ICMS_BC AS NCI_BASE_ICMS,
NCI.ICMS_VALOR,
NCI.ICMS_CST,
NCI.ICMS_CSOSN,
NCI.IPI_BASE,
NCI.IPI_VALOR,
GR.GRADE,
PGI.BARRAS AS BARRA_GRADE,
PGI.ESTOQUE AS ESTOQUE_GRADE


FROM FORNECEDOR FR
INNER JOIN NOTA_COMPRA NC ON FR.ID_FORNECEDOR = NC.ID_FORNECEDOR
INNER JOIN NOTA_COMPRA_DETALHE NCI ON NC.ID = NCI.ID_NFE
INNER JOIN PRODUTOS P ON P.ID_PRODUTO = NCI.ID_PRODUTO
LEFT JOIN PRODUTOS_GRADE_ITENS PGI ON PGI.ID_PRODUTO = NCI.ID_PRODUTO
LEFT JOIN GRADE GR ON PGI.ID_GRADE = GR.ID